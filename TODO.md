# MyStar 구현 TODO

> 마지막 업데이트: 2026-02-11

---

## 남은 항목

### 밸런싱
- [ ] 전체 시즌 플레이 테스트
- [x] Agent-Team 기반 시뮬레이션 보정 시스템 분석 완료 (아래 수정안)
- [x] 수정안 코드 적용 (Step 1~5 완료)
- [x] 밀리맵 누락분 추가 (79개 → 219개, 나무위키 밀리맵 전체 포함)

---

## Agent-Team 분석 결과: 최종 수정안 (2026-02-11)

> Phase 1(5명 분석) → Phase 2(3명 취합) → Phase 3(교차 분석) 완료

### Step 1: enums.dart — 빌드 상성 수정

#### 빌드 스타일 오분류 3건
| 빌드 | 현재 | 수정 | 이유 |
|------|------|------|------|
| zvt3HatchMutal | aggressive | **balanced** | 매크로 빌드인데 공격형 분류 |
| zvzSpeedlingAllIn | balanced | **aggressive** | 올인 빌드인데 밸런스 분류 |
| pvzCorsairReaver | aggressive | **balanced** | 운영형 견제인데 공격형 분류 |

#### _getStyleAdvantage() 상성값 3건
| 매치업 | 현재 | 수정 | 이유 |
|--------|------|------|------|
| Aggressive vs Defensive | +15 | **+10** | 공격형 과유리 완화 |
| Defensive vs Aggressive | +8 | **+12** | 수비 성공 보상 강화 |
| Balanced vs Aggressive | +5 | **+8** | 밸런스형 카운터 강화 |

#### _getSpecificAdvantage() 카운터 12~15개 추가
```
현재: TvT 0개, PvP 0개, PvT역방향 0개, ZvP역방향 0개
추가:
  TvT: proxy→ccFirst(+20), ccFirst→proxy(-25), 1factPush→ccFirst(+15),
       wraith→2barracks(-10), 2fac→1factPush(+10)
  PvP: darkAllIn→2gateDragoon(+15), cannonRush→1gateRobo(-20),
       reaverDrop→zealotRush(+10)
  PvT: 2gateZealot→tvpDouble(+15), 1gateObs→tvpWraithRush(+10)
  ZvP: 3hatchHydra→forgeCannon(+12), 2hatchMutal→nexusFirst(+15)
```

### Step 2: map_data.dart — 맵 상성 수정

#### 19개 맵 상성 순환 깨짐 수정 (tvz+zvp+pvt 3개 모두 >50 불가능)
대표 수정:
| 맵 | 현재 (tvz/zvp/pvt) | 수정 | 비고 |
|----|---------------------|------|------|
| 패스파인더 | 65/65/60 | 55/60/55 | 극단적 상성 완화 |
| 네오문글레이브 | 60/64/65 | 60/40/65 | 저그 불리맵 반영 |
| 데스페라도 | 62/58/65 | 48/45/65 | 토스맵 특성 반영 |
| 백마고지 | 65/56/65 | 55/40/65 | 토스맵 반영 |
| 레퀴엠 | 57/58/59 | 57/42/59 | 짧은 맵 특성 반영 |
| 지오메트리 | 65/65/43 | 65/45/43 | 테란맵 순환 유지 |
| (나머지 13개) | ... | ... | 상성 순환 원칙 적용 |

#### rushDistance와 상성 불일치 수정
| 맵 | 문제 | 수정 |
|----|------|------|
| 벤젠 (rd=0.85) | tvz=64 테란맵 (넓은 맵인데) | tvz=48 저그유리 |
| 배틀로얄 (rd=0.4) | tvz=35 저그맵 (좁은 맵인데) | tvz=50 중립 |

#### 밀리맵 누락분 추가 (별도 조사 진행 중)

### Step 3: match_simulation_service.dart — 시뮬레이션 엔진 수정

#### [긴급] 종족 상성 증폭 완화
```dart
// 현재: baseWinRate = 50.0 + raceDeviation * 2.0  (±30% 효과)
// 수정: baseWinRate = 50.0 + raceDeviation * 1.0  (±15% 효과)
```

#### [높음] _determineBuildType()에 맵 파라미터 추가
```
rushDistance <= 0.4: cheese/aggressive 빌드 점수 +200
rushDistance >= 0.7: defensive/balanced 빌드 점수 +200
```

#### [중간] macroMapEvents 조건 완화
```dart
// 현재: gamePhase == GamePhase.late (후반에만)
// 수정: gamePhase != GamePhase.early (중반부터)
```

#### [높음] scout 맵 보너스 추가
```
rushDistance >= 0.7 시 scout 보너스 추가 (넓은 맵에서 정찰 중요)
```

### Step 4: build_orders.dart — 빌드 이벤트 수정

#### [높음] buildTypeEvents 누락 6개 빌드 추가
tvtCCFirst, tvtVultureHarass, zvz3HatchHydra, zvzSpeedlingAllIn, pvpZealotRush, pvpCorsairReaver

#### [높음] keyStats에 scout 추가 (5~6개 빌드)
pvt1GateObserver, tvzSKTerran, zvtHatchSpore, pvzCorsairReaver, pvpCorsairReaver

#### [중간] favorsStat 중복 해소 (4개 빌드)
| 빌드 | 현재 | 수정 |
|------|------|------|
| pvzForgeCannon | defense×2 | defense + macro |
| pvzNexusFirst | macro×2 | macro + defense |
| pvpCannonRush | attack×2 | attack + sense |
| pvz2GateZealot | attack×2 | attack + control |

#### [중간] tvzSKTerran 전용 이벤트 추가 (2→3개)

### Step 5: battle_events.dart — scout 이벤트 추가

scout 이벤트 12~15개 추가 (현재 13 → 25~28)

### 예상 효과

| 항목 | Before | After |
|------|--------|-------|
| 맵 상성 영향 | ±30% | ±15% |
| 3종 모두 유리 맵 | 19개 | 0개 |
| 빌드-맵 연동 | 없음 | rushDistance 기반 |
| buildTypeEvents 누락 | 6개 | 0개 |
| 특수 상성 카운터 | 10개 | 22~25개 |
| scout 활용도 | 하 (keyStats 0) | 중상 (keyStats 5~6) |
| Agg vs Def 유리도 | +15% | +10% |

---

## Agent-Team: 맵·능력치·빌드 상관관계 보정 시스템

> **목표**: 현재 이벤트 풀 및 빌드오더의 문제점을 시뮬레이션으로 파악 → 수정 반복하여,
> 실제 스타크래프트 경기를 텍스트로 체감할 수 있는 수준으로 보정

### 조직 구조

```
┌─────────────────────────────────────────────────┐
│                 총괄 코디네이터                    │
│  (3개 축의 보정 요청을 종합하여 최종 수정안 도출)    │
├────────────┬────────────────┬────────────────────┤
│ 빌드 취합자  │   맵 취합자     │  능력치 취합자      │
│ (모든 빌드   │  (모든 맵       │ (모든 능력치       │
│  담당자 취합) │   담당자 취합)  │  담당자 취합)      │
├────────────┼────────────────┼────────────────────┤
│ 빌드 담당자  │   맵 담당자     │  능력치 담당자      │
│ ×빌드 수    │  ×맵 수        │  ×8개             │
└────────────┴────────────────┴────────────────────┘
```

### 1. 빌드 (Build) 담당자 — 빌드 1개 = 담당자 1명

> 예시: **"테란 8배럭" 담당자**

**수행 범위**: 8배럭 빌드 하나를 들고 → 전체 맵 × 해당 종족전(TvZ, TvP, TvT) 조합을 전부 시뮬레이션

**검증 항목**:
- 맵별 승률 편차: 좁은 맵에서 러시 성공률↑, 넓은 맵에서↓ 가 반영되는지
- 종족전별 적절성: TvZ에서 8배럭이 저글링 러시에 대응하는 텍스트가 나오는지
- 텍스트 품질: 빌드 스텝 텍스트가 자연스럽고 다양한지, 중복 표현은 없는지
- 상성 체감: 상대 빌드와의 맞물림이 실제 스타크래프트와 유사한지

**보고 예시**:
- "8배럭이 네오일렉트릭써킷(넓은맵)에서도 TvZ 승률 60% → 맵 크기 패널티 필요"
- "8배럭 vs 5드론 성큰러쉬 텍스트에서 벙커 건설 이벤트가 누락됨"
- "8배럭 TvT 미러전 텍스트가 단조로움, 변수 이벤트 추가 필요"

**빌드 담당자 목록** (빌드오더 수만큼 존재):
| 종족 | 빌드 담당자 | 시뮬 범위 |
|------|------------|----------|
| 테란 | 8배럭, 벙커링, 2팩벌처, SK테란, 3팩골리앗, 레이스견제, 메카닉드랍... | 각각 × 전체맵 × 종족전 |
| 저그 | 4드론, 원해처리러커, 3해처리뮤탈, 미친저그, 5드론, 12풀, 12앞마당... | 각각 × 전체맵 × 종족전 |
| 프로토스 | 21투게이트, 패스트다크, 드라군리버, 커세어다크, 패스트캐리어, 캐논러쉬... | 각각 × 전체맵 × 종족전 |

→ **빌드 취합자**: 모든 빌드 담당자의 보정 요청을 수집·정리하여 공통 패턴 도출

### 2. 맵 (Map) 담당자 — 맵 1개 = 담당자 1명

> 예시: **"네오일렉트릭써킷" 담당자**

**수행 범위**: 네오일렉트릭써킷 맵에서 → 9개 종족전(TvZ, TvP, TvT, ZvT, ZvP, ZvZ, PvT, PvZ, PvP) 전부 시뮬레이션

**검증 항목**:
- 맵 특성 반영: 넓은 맵이면 매크로 빌드 유리, 좁으면 러시 유리가 실제로 나타나는지
- 종족전별 승률: 이 맵에서 특정 종족이 극단적으로 유리/불리하지 않은지
- 빌드 선택 적절성: 맵 특성에 안 맞는 빌드가 선택되고 있지 않은지
- 텍스트 현실감: 맵 이름·특성이 해설 텍스트에 반영되는지

**보고 예시**:
- "네오일렉트릭써킷 PvZ에서 프로토스 승률 70% → 저그 빌드 보강 또는 맵 보정 필요"
- "이 맵은 멀티가 많은데 초반 러시 빌드 선택률이 너무 높음"
- "맵 특성(언덕, 길목)이 텍스트에 전혀 반영되지 않음"

**맵 담당자 목록** (게임 내 맵 수만큼 존재):
| 맵 담당자 | 시뮬 범위 |
|----------|----------|
| 네오일렉트릭써킷, 파이썬, 신백두대간, 타우크로스, 카트리나, 아카디아, 블루스톰... | 각각 × 9개 종족전 × 해당 종족전 빌드 전체 |

→ **맵 취합자**: 모든 맵 담당자의 보정 요청을 수집·정리하여 맵간 일관성 확인

### 3. 능력치 (Stats) 담당자 — 능력치 1개 = 담당자 1명

> 예시: **"공격력" 담당자**

**수행 범위**: 공격력이 극단적으로 높은/낮은 가상 선수를 만들어 → 전체 맵 × 전체 종족전 시뮬레이션

**검증 항목**:
- 능력치-빌드 상관: 공격력↑ 선수가 러시 빌드에서 확실히 유리한지
- 능력치-맵 상관: 짧은 맵에서 공격력 효과↑, 긴 맵에서 효과↓ 가 반영되는지
- 역전 시나리오: 공격력↑ 선수가 긴 맵에서 무리하게 초반빌드 → 패배 같은 현실적 전개가 나오는지
- 텍스트 체감: 공격력 높은 선수의 경기에서 "강력한 화력", "압도적 공세" 같은 표현이 나오는지
- 독립적 영향: 다른 능력치와 겹치지 않고 고유한 역할을 하는지

**보고 예시**:
- "공격력 최상위 선수가 긴 맵 + 매크로 빌드에서도 승률이 높음 → 맵 크기에 따른 감쇠 필요"
- "공격력 차이가 10% 이상인데 시뮬 텍스트에서 체감이 안 됨"
- "공격력과 견제 능력치가 거의 동일한 역할 → 차별화 필요"

**능력치 담당자 목록** (8명 고정):
| 능력치 담당자 | 검증 초점 |
|-------------|----------|
| 센스 | 상대 빌드 읽기, 기습 감지, 타이밍 판단 |
| 컨트롤 | 소수 유닛 전투 효율, 마이크로 체감 |
| 공격력 | 러시/올인 성공률, 전투 화력 |
| 견제 | 멀티 견제, 일꾼 사냥, 드랍 성공률 |
| 전략 | 빌드 선택 적절성, 전환 타이밍 |
| 물량 | 자원 효율, 리맥스 속도, 장기전 유리 |
| 수비력 | 러시 방어, 수비 시설 효율, 생존력 |
| 정찰 | 정찰 성공률, 정보 기반 대응 |

→ **능력치 취합자**: 8명의 보정 요청을 수집·정리, 능력치 간 밸런스 확인

### 보정 워크플로우

```
Phase 1: 개별 담당자 시뮬레이션 (병렬 실행)
═══════════════════════════════════════════
  빌드 담당자들 (병렬)        맵 담당자들 (병렬)         능력치 담당자들 (병렬)
  ┌──────────────┐         ┌──────────────┐          ┌──────────────┐
  │ 8배럭 담당자   │         │ 파이썬 담당자   │          │ 공격력 담당자  │
  │→ 전체맵×종족전 │         │→ 9개 종족전    │          │→ 전체맵×종족전 │
  │→ N회 시뮬     │         │→ N회 시뮬     │          │→ N회 시뮬     │
  │→ 보정 보고서   │         │→ 보정 보고서   │          │→ 보정 보고서   │
  ├──────────────┤         ├──────────────┤          ├──────────────┤
  │ 벙커링 담당자  │         │ 네오일렉 담당자 │          │ 컨트롤 담당자  │
  │→ ...         │         │→ ...         │          │→ ...         │
  ├──────────────┤         ├──────────────┤          ├──────────────┤
  │ ...          │         │ ...          │          │ ... (×8)     │
  └──────┬───────┘         └──────┬───────┘          └──────┬───────┘
         │                        │                         │
Phase 2: 취합자 정리
═══════════════════════════════════════════
         ▼                        ▼                         ▼
  ┌──────────────┐         ┌──────────────┐          ┌──────────────┐
  │  빌드 취합자   │         │  맵 취합자     │          │ 능력치 취합자  │
  │ 전체 빌드의   │         │ 전체 맵의     │          │ 8개 능력치의  │
  │ 공통 문제 도출 │         │ 공통 문제 도출 │          │ 밸런스 문제   │
  └──────┬───────┘         └──────┬───────┘          └──────┬───────┘
         │                        │                         │
Phase 3: 총괄 코디네이터
═══════════════════════════════════════════
         └────────────────┬───────────────┘
                          ▼
                 ┌─────────────────┐
                 │  총괄 코디네이터   │
                 │                 │
                 │ 3축 보고서 교차  │
                 │ 분석 → 충돌 해소 │
                 │ → 최종 수정안    │
                 └────────┬────────┘
                          │
Phase 4: 수정 적용
═══════════════════════════════════════════
                          ▼
              ┌───────────────────────┐
              │ build_orders.dart     │
              │ battle_events.dart    │
              │ match_simulation_svc  │
              │ initial_data.dart     │
              └───────────┬───────────┘
                          │
Phase 5: 재시뮬레이션 → Phase 1로 반복
═══════════════════════════════════════════
```

### 핵심 보정 대상 파일

| 파일 | 내용 |
|------|------|
| `lib/core/constants/build_orders.dart` | 빌드오더 정의 (스텝, 텍스트, 라인) |
| `lib/core/constants/battle_events.dart` | 전투 이벤트 풀 (인터랙션, 코멘터리) |
| `lib/domain/services/match_simulation_service.dart` | 경기 시뮬레이션 엔진 (승률, 능력치 반영) |
| `lib/core/constants/initial_data.dart` | 맵 데이터, 초기 설정 |

### 보정 기준

- **승률 균형**: 종족전별 승률 45~55% 범위 (극단적 편향 방지)
- **맵 개성**: 같은 종족전이라도 맵에 따라 체감이 달라야 함
- **능력치 체감**: 8개 능력치가 모두 의미있게 경기에 영향을 줘야 함
- **텍스트 품질**: 중복 없이 다양하고, 실제 프로리그 해설 톤 유지
- **빌드 다양성**: 한 종족전에서 다양한 빌드가 고르게 선택되어야 함

### 참고 자료 (나무위키)

| 주제 | URL |
|------|-----|
| 테란 빌드오더 | https://namu.wiki/w/%EC%8A%A4%ED%83%80%ED%81%AC%EB%9E%98%ED%94%84%ED%8A%B8/%EC%A0%84%EB%9E%B5%EC%A0%84%EC%88%A0/%ED%85%8C%EB%9E%80 |
| 저그 빌드오더 | https://namu.wiki/w/%EC%8A%A4%ED%83%80%ED%81%AC%EB%9E%98%ED%94%84%ED%8A%B8/%EC%A0%84%EB%9E%B5%EC%A0%84%EC%88%A0/%EC%A0%80%EA%B7%B8 |
| 프로토스 빌드오더 | https://namu.wiki/w/%EC%8A%A4%ED%83%80%ED%81%AC%EB%9E%98%ED%94%84%ED%8A%B8/%EC%A0%84%EB%9E%B5%EC%A0%84%EC%88%A0/%ED%94%84%EB%A1%9C%ED%86%A0%EC%8A%A4 |
| 스타크래프트 맵 | https://namu.wiki/w/%EC%8A%A4%ED%83%80%ED%81%AC%EB%9E%98%ED%94%84%ED%8A%B8/%EB%A7%B5 |

---

## 완료 항목 (57개)

<details>
<summary>핵심 시스템 (10개)</summary>

- [x] 데이터 모델 (Player, Team, Match, Season, Item, Equipment, Inventory)
- [x] 상태 관리 (Riverpod)
- [x] 저장/로드 (Hive)
- [x] 경기 시뮬레이션 엔진 (빌드오더 기반)
- [x] 14경기 + 개인리그 일정 자동 생성
- [x] 선수 성장/하락 시스템
- [x] 레벨(1~20, 경험치) + 커리어(5단계, 시간) 분리 시스템
- [x] 선수 vs 선수 상대 전적 기록
- [x] 개인리그 시드 순위 반영
- [x] PC방 예선 같은 팀 회피 조 편성
</details>

<details>
<summary>화면 (22개)</summary>

타이틀, 감독명 입력, 팀 선택, 맵 추첨, 이적, 메인 메뉴, 로스터 선택, 경기 시뮬레이션, 저장/로드, 선수 정보, 선수 순위, 구단 순위, 연습경기, 시즌 종료, 위너스리그, PC방 예선, 듀얼토너먼트, 조지명식, 본선 토너먼트, 아이템 상점, 행동 관리, 장비 관리
</details>

<details>
<summary>AI/시즌 시스템 (6개)</summary>

- [x] AI 컨디션/특훈/팬미팅/아이템 관리
- [x] 시즌 완료 처리 (레벨업, 은퇴, 신인 생성)
- [x] 플레이오프 UI (3/4위전 → 2/3위전 → 결승전)
</details>

<details>
<summary>부가 기능 (7개)</summary>

- [x] 선수 사진 등록, R 버튼, Preview 모드
- [x] go_router, 반응형 레이아웃 (Responsive.sp)
- [x] 승리 보상 + 대회 상금 시스템
</details>

<details>
<summary>UI 개선 (12개)</summary>

- [x] 시스템 정리 (부상/특수상태 제거, 타팀 전적 기록)
- [x] 로스터 화면 레이아웃 개선
- [x] 로스터 제출 화면 (3열 구조, 맵 순차 매핑)
- [x] 듀얼토너먼트 화면 (종족 표시, 아마추어 지원)
- [x] 경기 결과 화면 (세트별 결과, ACE 표시)
- [x] PC방 예선 조 편성 (24개조 + 아마추어 채움)
- [x] 매치 시뮬레이션 개선 (에이스결정전, NEXT 클릭)
- [x] 구단 순위 화면 (UI 통일, 색상 추가)
- [x] 선수 정보 화면 (8각형 차트, 전적 탭)
- [x] 조지명식 화면 (가로 배치, 통과자 박스)
- [x] 행동력 화면 (전체 조회, 일괄 진행)
- [x] 맵 추첨 화면 (썸네일, 정보 박스)
</details>

---

## 게임 규칙

| 항목 | 내용 |
|------|------|
| 로스터 | 최소 10명 |
| 경기 형식 | 7전 4선승제 |
| 능력치 | 센스/컨트롤/공격력/견제/전략/물량/수비력/정찰 (8개) |
| 등급 | F- ~ SSS (25단계) |
| 레벨 | 1~20 (경험치 기반, 레벨업 시 능력치 상승) |
| 커리어 | 신인→상승세→전성기→베테랑→노장 (시간 기반) |
| 컨디션 | 내부 0~110, 표시 0~100 |
| 승률 계산 | 능력치 50당 1% (최대 ±40%) + 레벨당 ±2% |
| 승패 조건 | 병력 4:1 격차 또는 200줄 강제 판정 |
| 보상 | 승리 +5만원, 프로리그 우승 150만/준우승 70만, 개인리그 우승 80만/준우승 40만 |
